# Internationalisation (i18n) and Accessibility Text (a11y)

This package uses Yii’s built-in internationalisation system (Yii::t()) for all user-facing strings, including accessibility text such as alt, aria-label, etc.

## Message categories

This package uses the following message categories:

* p2m.rbac
* p2m.rbac.*
* Accessibility text (a11y):
* p2m.rbac.a11y
* p2m.rbac.a11y.*

As a consumer, you decide:

* which languages you support
* where translations live in your application
* how/when you update them

## Recommended directory layout

In your Yii2 application, keep i18n tooling and configs under:

```
@app/i18n/
```

Example:

```tree
@app/i18n/
├─ messages/
│   ├─ en/
│   └─ ...
├─ app.php
├─ p2y2-things.php
├─ p2y2-admin.php
└─ p2y2-rbac-users.php
```

Your translation files typically live under:

```
@app/i18n/messages/<lang>/<category>.php
```

Examples:

```
@app/i18n/messages/ru/p2m.rbac.a11y.php
@app/i18n/messages/kk/p2m.rbac.php
```

## Extracting messages from this package

Yii extracts messages using yii message/extract. The most portable approach is to use one extract config per package, then run extraction for each config.

### 1) Create @app/i18n/p2y2-rbac-users.php

Copy the following into your application:

```
<?php
/**
 * Extract messages from p2made/p2y2-rbac-users into this application.
 *
 * Run:
 *   ./yii message/extract @app/i18n/p2y2-rbac-users.php
 */
return [
	// Where to scan for Yii::t() calls
	'sourcePath' => '@vendor/p2made/p2y2-rbac-users',

	// Where extracted translations are written
	'messagePath' => '@app/messages',

	// Consumer chooses languages
	// Example only - replace with your language list
	'languages' => [
		'ru','kk','ky','tg','tk','uz','az','mn','tr',
	],

	'translator' => 'Yii::t',
	'sort' => true,
	'overwrite' => true,

	// Consumer choice:
	// - false keeps old keys around until you decide to remove them
	// - true removes keys no longer present in source
	'removeUnused' => false,

	// Only categories belonging to this package
	'only' => [
		'p2m.rbac',
		'p2m.rbac.*',
	],

	'onlyFileTypes' => ['php'],

	// Avoid scanning non-source directories
	'except' => [
		'/messages/',
		'/tests/',
		'/test/',
		'/runtime/',
		'/vendor/',
	],
];
```

### 2) Run extraction

From your application root:

```
./yii message/extract @app/i18n/p2y2-rbac-users.php
```

Yii will generate/update translation files under:

```
@app/messages/<lang>/p2m.rbac.php
@app/messages/<lang>/p2m.rbac.a11y.php
```

## Loading the messages at runtime

Add i18n configuration in your application (commonly common/config/main.php):

```
'i18n' => [
	'translations' => [
		'p2m.rbac*' => [
			'class' => yii\i18n\PhpMessageSource::class,
			'basePath' => '@app/messages',
			'sourceLanguage' => 'en',
		],
	],
],
```






⸻






...



Notes:
* The wildcard p2m.rbac* covers p2m.rbac, p2m.rbac.a11y, and any future subcategories.
* basePath should match where you write your message files.
* If your messages are in @common/messages (common in advanced template), use that instead.

Can packages provide a config file for consumers to include?

Yes — and it’s a good idea as long as it stays consumer-controlled.

A practical pattern is:
* Package ships a base config fragment containing only the stable parts (category prefix + vendor path + safe excludes)
* Consumer imports it and adds:
* languages
* messagePath
* their own extraction preferences (removeUnused, etc.)

Proposed package file

This package may ship:

i18n/i18n.config.php

Containing a base array only:

<?php
return [
	'sourcePath' => '@vendor/p2made/p2y2-rbac-users',
	'only' => [
		'p2m.rbac',
		'p2m.rbac.*',
	],
	'onlyFileTypes' => ['php'],
	'except' => [
		'/messages/',
		'/tests/',
		'/test/',
		'/runtime/',
		'/vendor/',
	],
	'translator' => 'Yii::t',
	'sort' => true,
	'overwrite' => true,
];

Consumer usage

In your app:

<?php
$base = require Yii::getAlias('@vendor/p2made/p2y2-rbac-users/i18n/i18n.config.php');

return array_merge($base, [
	'messagePath' => '@app/messages',
	'languages' => ['ru','kk','ky'],
	'removeUnused' => false,
]);

Notes on merging
* array_merge() replaces scalar keys cleanly.
* For nested arrays (like except, only) you usually don’t want to merge at all — you want the package’s version to remain authoritative. If you do need to extend, do it explicitly (e.g. array_merge($base['except'], [...])).

This pattern keeps the package “helpful but not presumptive”.

i18n and a11y as first-class considerations

This package treats i18n and accessibility text as first-class requirements:
* All user-facing strings must be wrapped in Yii::t() with package categories (p2m.rbac*).
* Accessibility strings (e.g. alt, aria-label, screen-reader-only labels) are translated under p2m.rbac.a11y*.
* Do not hardcode English accessibility labels in views/helpers/widgets; use message keys.

Category guidance
* General UI text: p2m.rbac
* Accessibility text: p2m.rbac.a11y

This keeps translations organised and makes it easy for consumers to prioritise a11y coverage.

⸻

Quick checklist for consumers
	1.	Add i18n mapping for p2m.rbac*
	2.	Create @app/i18n/p2y2-rbac-users.php
	3.	Set your languages
	4.	Run ./yii message/extract @app/i18n/p2y2-rbac-users.php
	5.	Translate the generated files under @app/messages/<lang>/

⸻

My thoughts on your questions
* @app/i18n/: agree — it’s tidy, discoverable, and keeps tooling separate from runtime messages/.
* Package-provided config fragment: yes, do it — but only as a base to import/override; never embed language choices.
* i18n/a11y first class: fully aligned. The main discipline is: every new UI string (including a11y strings) must be added via Yii::t('p2m.rbac…', ...) from day one.

If you want, I can also draft the matching i18n/i18n.config.php file contents for the package (the base fragment referenced above), and a tiny README snippet linking to i18n.md.



```
<?php
return [
	'sourcePath' => '@app',
	'messagePath' => '@app/messages',
	'languages' => ['ru','kk','ky','tg','tk','uz','az','mn','tr'],
	'translator' => 'Yii::t',
	'sort' => true,
	'overwrite' => true,
	'removeUnused' => false,

	// Tell the extractor which categories to keep
	'only' => [
		// app categories (example)
		'app',
		'app.*',

		// p2y2 packages
		'p2m.rbac',
		'p2m.rbac.*',
		'p2m.things',
		'p2m.things.*',
		'p2m.admin',
		'p2m.admin.*',
	],

	'onlyFileTypes' => ['php'],

	// IMPORTANT: most default configs exclude /vendor/ entirely.
	// Here we exclude most vendor, but NOT vendor/p2made.
	'except' => [
		'/runtime/',
		'/vendor/yiisoft/',
		'/vendor/twbs/',
		'/vendor/bower-asset/',
		'/vendor/npm-asset/',
		'/vendor/bin/',
		'/vendor/**/tests/',
		'/vendor/**/Test/',
		'/vendor/**/test/',
		'/vendor/**/messages/',

		// Do NOT add '/vendor/' globally, or you’ll exclude p2made too.
	],

	// Add an extra scan root for p2made packages (works well in practice)
	'additionalSourcePaths' => [
		'@vendor/p2made',
	],
];
```
